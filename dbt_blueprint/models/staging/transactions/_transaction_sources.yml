version: 2

sources: 
  - name: transactions
    tags: ["transactions"]
    catalog: ingestion
    schema: dbt_blueprint_dummy_ingestion
    tables:
      - name: raw_p2b_captured_events
        description: "Table containing raw P2B captured transaction events"
        freshness:
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
        columns:
          - name: transactionId
            datatests:
              - not_null
              - unique
          - name: sender_user_id
          - name: receiver_user_id
          - name: merchant_id
          - name: sender_payment_source_id
          - name: receiver_payment_source_id
          - name: country_code
          - name: currency_code
          - name: amount
          - name: message
          - name: event_time
          - name: recorded_time

      - name: raw_p2b_failed_events
        description: "Table containing raw P2B failed transaction events"
        freshness:
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
        columns:
          - name: transactionId
            datatests:
              - not_null
              - unique
          - name: sender_user_id
          - name: receiver_user_id
          - name: merchant_id
          - name: sender_payment_source_id
          - name: receiver_payment_source_id
          - name: country_code
          - name: currency_code
          - name: amount
          - name: message
          - name: event_time
          - name: recorded_time

      - name: raw_p2p_captured_events
        description: "Table containing raw P2P captured transaction events"
        freshness:
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
        columns:
          - name: transactionId
            datatests:
              - not_null
              - unique
          - name: sender_user_id
          - name: receiver_user_id
          - name: merchant_id
          - name: sender_payment_source_id
          - name: receiver_payment_source_id
          - name: country_code
          - name: currency_code
          - name: amount
          - name: message
          - name: event_time
          - name: recorded_time

      - name: raw_p2p_failed_events
        description: "Table containing raw P2P failed transaction events"
        freshness:
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
        columns:
          - name: transactionId
            datatests:
              - not_null
              - unique
          - name: sender_user_id
          - name: receiver_user_id
          - name: merchant_id
          - name: sender_payment_source_id
          - name: receiver_payment_source_id
          - name: country_code
          - name: currency_code
          - name: amount
          - name: message
          - name: event_time
          - name: recorded_time